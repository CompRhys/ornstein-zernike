# Closure
Machine Learning to infer improved closure relationships for the Ornstein-Zernike equation

The following collections of code were used to first generate then analyse data on the structures of simple liquids.

The data was generated by performing forward molecular dynamics simulations for specified potentials. From this the radial distribution function and then the direct correlation function were extracted.

This data was then used as an input for the inverse problem of solving to find the interaction potential given structural infomation about the system. 

Various machine learning algorithms were applied in order to do this.
The critical results were that symbolic regression over the broad dataset recovers the hypernetted-chain closure showing that a data driven approach is consistent with current analytical theories. The second significant result is that use of a non-local closure relationship offers increased efficacy when compared to local closure relationships. Non-locality is intractable analytically and so this demonstrates the fact that machine learning allows us to gain further predictive insight into physical systems that is otherwise impractical to obtain.

# Instructions for local use:
* Install comprhys/espresso.git
* Run tables.py to generate the tables
* Run system.py to build the input file
* Use input="`awk "NR==<row>" <input_file>`" to grab a row from the input file
* Run bulk.py to get the bulk properties and henderson.py to get the cavity results.
* Run process.py to work out the direct correlation and bridge functions
* Run clean.py to remove the non-liquid samples

# Todo:
* Apply arcsinh transform to the data and then experiment with different loss functions
* Look at an inverse design application i.e. a porous fluid. This is done by simulating large colloids in small colloids and then using only the small colloid correlations. The inverted potential should then be able to recover the small colloid structure without the need for larger colloids if the methodology works.
* Iterative Ornstein-Zernike Inversion.
